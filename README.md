# EvoGenerator
# An Evolutionary Approach for Image Generation using Convolutional Neural Networks

Image generation or image synthesis is the task of generating new images using machine learning techniques. Several successful applications of neural networks for image generation are proposed. [1] used deep neural networks to create high quality artistic images from arbitrary images given to it as input. In practice however, one of the most difficult types of image generation is that of generating meaningful images from scratch, i.e. starting with a random image and turning it into a meaningful one.

Convolutional Neural Networks (CNN) is known to be a powerful method for extracting relevant features from high-dimensional data, particularly from image data. CNN employs various filtering and pooling procedures to convert a high-resolution image with thousands if not millions of pixels into a much lower dimensional representation. Studies [2] have shown that CNNs extract high-level features in their initial layers while the later layers extract lower-level features, until before the very last fully-connected layers that end-up making the classification decision.

On the other hand, Evolutionary Algorithms (EAs) are among the widely used metaheuristics for global multi-objective optimization. Genetic Algorithm (GA) is one of the most popular evolutionary algorithms. Initially conceived by John Holland [3], GA involves some concepts from Darwinian natural evolution theory, such as selection, crossover and mutation. GA follows an evolutionary process in which a huge number of candidate solutions to a problem are generated and get evolved across multiple generations. It starts with random initialization of the population and then enter the iterative evolutionary process to evaluate, select and improve the individuals. Genetic operators play the major role in this evolution. The quality of each candidate solution, i.e. an individual with respect to the objective(s) is measured by a fitness function. As in the natural evolution theory, fitter individuals have a higher chance of survival in the evolutionary process. This iterative process continues as long as the stopping criteria is not met, which can be a certain number of iterations, fitness value of the best solution found, or the case when there is no fitness improvement anymore (a situation that is called “convergence”).

In this work, we are developing EvoGenerator, an image generation tool where a convolutional neural network trained on a very large dataset (e.g. ImageNet) is incorporated into the fitness function of a genetic algorithm. The GA is initialized with some random images, but then uses the CNN’s classification score, i.e. the neuron activation value in the final layer of the CNN as the fitness score to evolve the random images into meaningful ones. As an example, let’s have a CNN trained to classify “orange” images, i.e. when you pass an image to this CNN, it returns the probability of the input image containing an orange. Now we can have a GA with its individuals being some random images. We can pass each of this individuals to the trained CNN to get the probability of each image containing an orange. Obviously, the more the individual image looks like containing an orange, the higher its fitness score will be. So the GA evolves around higher fitness individuals and end-up generating images that more and more look like containing oranges. For this purpose, we used DenseNet121 [4], a very deep and densely connected convolutional network with 121 layers. Also, our GA uses two-points crossover, random resetting mutation, and elitism.

# References
[1] Gatys, L. A., Ecker, A. S., & Bethge, M. (2015). A neural algorithm of artistic style. arXiv preprint arXiv:1508.06576.  
[2] Zeiler, M. D., & Fergus, R. (2014, September). Visualizing and understanding convolutional networks. In European conference on computer vision (pp. 818-833). Springer, Cham.  
[3] Holland, J. (1975). Adaptation in natural and artificial systems: an introductory analysis with application to biology. Control and artificial intelligence.  
[4] Huang, G., Liu, Z., Van Der Maaten, L., & Weinberger, K. Q. (2017). Densely connected convolutional networks. In Proceedings of the IEEE conference on computer vision and pattern recognition (pp. 4700-4708).  
